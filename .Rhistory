outall <- do.call(rbind,out$samples)
pred <- list()
for(i in 1:dim(outall)[1]){
pred[[i]] <- exp(outall[i,"mu.sig"] +
outall[i,"bTemp.sig"]*temp_pred) } # Pred contains the list of the prediction of sigma for each iteration #(one prediction line per iteration)
predall <- do.call(rbind,pred) # All predictions/iterations together in one data frame (where columns are the prediction per each predictor (area) values)
lci <- uci <- mean.pred <- 0
for(i in 1:length(temp_pred)){
lci[i]  <- quantile(predall[,i],probs = 0.025)
uci[i]  <- quantile(predall[,i],probs = 0.975)
mean.pred[i]  <- mean(predall[,i])
}
# 2. Plot
plot(-15, xlim=c(5,25), ylim=c(0, 2000), main = s_temp[xxx], xlab = "Temperature", ylab = "Abundance") # area_SG_HA unscaled variable
polygon( x = c(temp_pred, rev(temp_pred)),
y = c(lci, rev(uci)),
col = adjustcolor(c("grey"),alpha.f = 0.6),
border = NA)
points(mean.pred ~ temp_pred, type="l")
}
par(mfrow = c(3,1),
mar = c(2,2,3,2),
oma = c(2,3,1,2))
for (xxx in 1:3){
setwd("S:/PhD/Second chapter/Data/Results/TRIM/6temp")
load(paste("HDS_",s_temp[xxx],".RData", sep = ""))
# 1. Predictions of the model Sigma ~ Temperature
temp_pred <- seq(5, 30, length.out = 500)
outall <- do.call(rbind,out$samples)
pred <- list()
for(i in 1:dim(outall)[1]){
pred[[i]] <- exp(outall[i,"mu.sig"] +
outall[i,"bTemp.sig"]*temp_pred) } # Pred contains the list of the prediction of sigma for each iteration #(one prediction line per iteration)
predall <- do.call(rbind,pred) # All predictions/iterations together in one data frame (where columns are the prediction per each predictor (area) values)
lci <- uci <- mean.pred <- 0
for(i in 1:length(temp_pred)){
lci[i]  <- quantile(predall[,i],probs = 0.025)
uci[i]  <- quantile(predall[,i],probs = 0.975)
mean.pred[i]  <- mean(predall[,i])
}
# 2. Plot
plot(-15, xlim=c(5,25), ylim=c(0, 2000), main = s_temp[xxx], xlab = "Temperature", ylab = "Abundance") # area_SG_HA unscaled variable
polygon( x = c(temp_pred, rev(temp_pred)),
y = c(lci, rev(uci)),
col = adjustcolor(c("grey"),alpha.f = 0.6),
border = NA)
points(mean.pred ~ temp_pred, type="l")
}
s_temp
s_temp <- temp_sig$sp
s_temp[1,3,7]
# Plot predicted values for temperature for significant species
setwd("S:/PhD/Second chapter/Data/Results/Plots/6temp/sig")
#pdf("6.pdf")
par(mfrow = c(3,1),
mar = c(2,2,3,2),
oma = c(2,3,1,2))
for (xxx in 1:3){
setwd("S:/PhD/Second chapter/Data/Results/TRIM/6temp")
load(paste("HDS_",s_temp[xxx],".RData", sep = ""))
# 1. Predictions of the model Sigma ~ Temperature
temp_pred <- seq(5, 30, length.out = 500)
outall <- do.call(rbind,out$samples)
pred <- list()
for(i in 1:dim(outall)[1]){
pred[[i]] <- exp(outall[i,"mu.sig"] +
outall[i,"bTemp.sig"]*temp_pred) } # Pred contains the list of the prediction of sigma for each iteration #(one prediction line per iteration)
predall <- do.call(rbind,pred) # All predictions/iterations together in one data frame (where columns are the prediction per each predictor (area) values)
lci <- uci <- mean.pred <- 0
for(i in 1:length(temp_pred)){
lci[i]  <- quantile(predall[,i],probs = 0.025)
uci[i]  <- quantile(predall[,i],probs = 0.975)
mean.pred[i]  <- mean(predall[,i])
}
# 2. Plot
plot(-15, xlim=c(5,25), ylim=c(0, 2000), main = s_temp[xxx], xlab = "Temperature", ylab = "Abundance") # area_SG_HA unscaled variable
polygon( x = c(temp_pred, rev(temp_pred)),
y = c(lci, rev(uci)),
col = adjustcolor(c("grey"),alpha.f = 0.6),
border = NA)
points(mean.pred ~ temp_pred, type="l")
}
#dev.off()
##♠ ?? This is wrong, ask Rahel how to plot predictions in sigma
s_temp <- s_temp[1,3,7]
s_temp
s_temp <- temp_sig$sp
s_temp <- s_temp[1,3,7]
s_temp
s_temp <- s_temp[c(1,3,7)]
s_temp
setwd("S:/PhD/Second chapter/Data/Results/Plots/6temp/sig")
#pdf("6.pdf")
par(mfrow = c(3,1),
mar = c(2,2,3,2),
oma = c(2,3,1,2))
for (xxx in 1:3){
setwd("S:/PhD/Second chapter/Data/Results/TRIM/6temp")
load(paste("HDS_",s_temp[xxx],".RData", sep = ""))
# 1. Predictions of the model Sigma ~ Temperature
temp_pred <- seq(5, 30, length.out = 500)
outall <- do.call(rbind,out$samples)
pred <- list()
for(i in 1:dim(outall)[1]){
pred[[i]] <- exp(outall[i,"mu.sig"] +
outall[i,"bTemp.sig"]*temp_pred) } # Pred contains the list of the prediction of sigma for each iteration #(one prediction line per iteration)
predall <- do.call(rbind,pred) # All predictions/iterations together in one data frame (where columns are the prediction per each predictor (area) values)
lci <- uci <- mean.pred <- 0
for(i in 1:length(temp_pred)){
lci[i]  <- quantile(predall[,i],probs = 0.025)
uci[i]  <- quantile(predall[,i],probs = 0.975)
mean.pred[i]  <- mean(predall[,i])
}
# 2. Plot
plot(-15, xlim=c(5,25), ylim=c(0, 2000), main = s_temp[xxx], xlab = "Temperature", ylab = "Abundance") # area_SG_HA unscaled variable
polygon( x = c(temp_pred, rev(temp_pred)),
y = c(lci, rev(uci)),
col = adjustcolor(c("grey"),alpha.f = 0.6),
border = NA)
points(mean.pred ~ temp_pred, type="l")
}
#dev.off()
##♠ ?? This is wrong, ask Rahel how to plot predictions in sigma
mtext("Temperature", side = 1, line = 2, cex = 0.8, outer = TRUE)
##♠ ?? This is wrong, ask Rahel how to plot predictions in sigma
mtext("Temperature", side = 1, line = 1, cex = 0.8, outer = TRUE)
mtext("Sigma", side = 2, line = 1, cex = 0.8, outer = TRUE)
setwd("S:/PhD/Second chapter/Data/Results/Plots/6temp/sig")
#pdf("6.pdf")
par(mfrow = c(3,1),
mar = c(2,2,3,2),
oma = c(2,3,1,2))
for (xxx in 1:2){
setwd("S:/PhD/Second chapter/Data/Results/TRIM/6temp")
load(paste("HDS_",s_temp[xxx],".RData", sep = ""))
# 1. Predictions of the model Sigma ~ Temperature
temp_pred <- seq(5, 30, length.out = 500)
outall <- do.call(rbind,out$samples)
pred <- list()
for(i in 1:dim(outall)[1]){
pred[[i]] <- exp(outall[i,"mu.sig"] +
outall[i,"bTemp.sig"]*temp_pred) } # Pred contains the list of the prediction of sigma for each iteration #(one prediction line per iteration)
predall <- do.call(rbind,pred) # All predictions/iterations together in one data frame (where columns are the prediction per each predictor (area) values)
lci <- uci <- mean.pred <- 0
for(i in 1:length(temp_pred)){
lci[i]  <- quantile(predall[,i],probs = 0.025)
uci[i]  <- quantile(predall[,i],probs = 0.975)
mean.pred[i]  <- mean(predall[,i])
}
# 2. Plot
plot(-15, xlim=c(5,25), ylim=c(0, 2000), main = s_temp[xxx], xlab = "Temperature", ylab = "Abundance") # area_SG_HA unscaled variable
polygon( x = c(temp_pred, rev(temp_pred)),
y = c(lci, rev(uci)),
col = adjustcolor(c("grey"),alpha.f = 0.6),
border = NA)
points(mean.pred ~ temp_pred, type="l")
}
xxx = 3 #(MICAL)
setwd("S:/PhD/Second chapter/Data/Results/TRIM/6temp")
load(paste("HDS_",s_temp[xxx],".RData", sep = ""))
# 1. Predictions of the model Sigma ~ Temperature
temp_pred <- seq(5, 30, length.out = 500)
outall <- do.call(rbind,out$samples)
pred <- list()
for(i in 1:dim(outall)[1]){
pred[[i]] <- exp(outall[i,"mu.sig"] +
outall[i,"bTemp.sig"]*temp_pred) } # Pred contains the list of the prediction of sigma for each iteration #(one prediction line per iteration)
predall <- do.call(rbind,pred) # All predictions/iterations together in one data frame (where columns are the prediction per each predictor (area) values)
lci <- uci <- mean.pred <- 0
for(i in 1:length(temp_pred)){
lci[i]  <- quantile(predall[,i],probs = 0.025)
uci[i]  <- quantile(predall[,i],probs = 0.975)
mean.pred[i]  <- mean(predall[,i])
}
# 2. Plot
plot(-15, xlim=c(5,25), ylim=c(-10, 100), main = s_temp[xxx], xlab = "Temperature", ylab = "Abundance") # area_SG_HA unscaled variable
polygon( x = c(temp_pred, rev(temp_pred)),
y = c(lci, rev(uci)),
col = adjustcolor(c("grey"),alpha.f = 0.6),
border = NA)
points(mean.pred ~ temp_pred, type="l")
##♠ ?? This is wrong, ask Rahel how to plot predictions in sigma
mtext("Temperature", side = 1, line = 1, cex = 0.8, outer = TRUE)
mtext("Sigma", side = 2, line = 1, cex = 0.8, outer = TRUE)
s_temp <- temp_sig$sp
s_temp
s_temp <- s_temp[c(2,3,6,7)]
s_temp
for (xxx in 1:2){
setwd("S:/PhD/Second chapter/Data/Results/TRIM/6temp")
load(paste("HDS_",s_temp[xxx],".RData", sep = ""))
# 1. Predictions of the model Sigma ~ Temperature
temp_pred <- seq(5, 30, length.out = 500)
outall <- do.call(rbind,out$samples)
pred <- list()
for(i in 1:dim(outall)[1]){
pred[[i]] <- exp(outall[i,"mu.sig"] +
outall[i,"bTemp.sig"]*temp_pred) } # Pred contains the list of the prediction of sigma for each iteration #(one prediction line per iteration)
predall <- do.call(rbind,pred) # All predictions/iterations together in one data frame (where columns are the prediction per each predictor (area) values)
lci <- uci <- mean.pred <- 0
for(i in 1:length(temp_pred)){
lci[i]  <- quantile(predall[,i],probs = 0.025)
uci[i]  <- quantile(predall[,i],probs = 0.975)
mean.pred[i]  <- mean(predall[,i])
}
# 2. Plot
plot(-15, xlim=c(5,25), ylim=c(0, 2000), main = s_temp[xxx], xlab = "Temperature", ylab = "Abundance") # area_SG_HA unscaled variable
polygon( x = c(temp_pred, rev(temp_pred)),
y = c(lci, rev(uci)),
col = adjustcolor(c("grey"),alpha.f = 0.6),
border = NA)
points(mean.pred ~ temp_pred, type="l")
}
s_temp
s_temp <- temp_sig$sp
s_temp
s_temp <- temp_sig$sp
s_temp <- s_temp[c(1,2)]
for (xxx in 1:2){
setwd("S:/PhD/Second chapter/Data/Results/TRIM/6temp")
load(paste("HDS_",s_temp[xxx],".RData", sep = ""))
# 1. Predictions of the model Sigma ~ Temperature
temp_pred <- seq(5, 30, length.out = 500)
outall <- do.call(rbind,out$samples)
pred <- list()
for(i in 1:dim(outall)[1]){
pred[[i]] <- exp(outall[i,"mu.sig"] +
outall[i,"bTemp.sig"]*temp_pred) } # Pred contains the list of the prediction of sigma for each iteration #(one prediction line per iteration)
predall <- do.call(rbind,pred) # All predictions/iterations together in one data frame (where columns are the prediction per each predictor (area) values)
lci <- uci <- mean.pred <- 0
for(i in 1:length(temp_pred)){
lci[i]  <- quantile(predall[,i],probs = 0.025)
uci[i]  <- quantile(predall[,i],probs = 0.975)
mean.pred[i]  <- mean(predall[,i])
}
# 2. Plot
plot(-15, xlim=c(5,25), ylim=c(0, 2000), main = s_temp[xxx], xlab = "Temperature", ylab = "Abundance") # area_SG_HA unscaled variable
polygon( x = c(temp_pred, rev(temp_pred)),
y = c(lci, rev(uci)),
col = adjustcolor(c("grey"),alpha.f = 0.6),
border = NA)
points(mean.pred ~ temp_pred, type="l")
}
par(mfrow = c(2,1),
mar = c(2,2,3,2),
oma = c(2,3,1,2))
for (xxx in 1:2){
setwd("S:/PhD/Second chapter/Data/Results/TRIM/6temp")
load(paste("HDS_",s_temp[xxx],".RData", sep = ""))
# 1. Predictions of the model Sigma ~ Temperature
temp_pred <- seq(5, 30, length.out = 500)
outall <- do.call(rbind,out$samples)
pred <- list()
for(i in 1:dim(outall)[1]){
pred[[i]] <- exp(outall[i,"mu.sig"] +
outall[i,"bTemp.sig"]*temp_pred) } # Pred contains the list of the prediction of sigma for each iteration #(one prediction line per iteration)
predall <- do.call(rbind,pred) # All predictions/iterations together in one data frame (where columns are the prediction per each predictor (area) values)
lci <- uci <- mean.pred <- 0
for(i in 1:length(temp_pred)){
lci[i]  <- quantile(predall[,i],probs = 0.025)
uci[i]  <- quantile(predall[,i],probs = 0.975)
mean.pred[i]  <- mean(predall[,i])
}
# 2. Plot
plot(-15, xlim=c(5,25), ylim=c(0, 2000), main = s_temp[xxx], xlab = "Temperature", ylab = "Abundance") # area_SG_HA unscaled variable
polygon( x = c(temp_pred, rev(temp_pred)),
y = c(lci, rev(uci)),
col = adjustcolor(c("grey"),alpha.f = 0.6),
border = NA)
points(mean.pred ~ temp_pred, type="l")
}
mtext("Temperature", side = 1, line = 1, cex = 0.8, outer = TRUE)
mtext("Sigma", side = 2, line = 1, cex = 0.8, outer = TRUE)
s_temp
s_temp <- temp_sig$sp
s_temp
s_temp <- s_temp[c(1,3)]
setwd("S:/PhD/Second chapter/Data/Results/Plots/6temp/sig")
#pdf("6.pdf")
par(mfrow = c(2,1),
mar = c(2,2,3,2),
oma = c(2,3,1,2))
for (xxx in 1:2){
setwd("S:/PhD/Second chapter/Data/Results/TRIM/6temp")
load(paste("HDS_",s_temp[xxx],".RData", sep = ""))
# 1. Predictions of the model Sigma ~ Temperature
temp_pred <- seq(5, 30, length.out = 500)
outall <- do.call(rbind,out$samples)
pred <- list()
for(i in 1:dim(outall)[1]){
pred[[i]] <- exp(outall[i,"mu.sig"] +
outall[i,"bTemp.sig"]*temp_pred) } # Pred contains the list of the prediction of sigma for each iteration #(one prediction line per iteration)
predall <- do.call(rbind,pred) # All predictions/iterations together in one data frame (where columns are the prediction per each predictor (area) values)
lci <- uci <- mean.pred <- 0
for(i in 1:length(temp_pred)){
lci[i]  <- quantile(predall[,i],probs = 0.025)
uci[i]  <- quantile(predall[,i],probs = 0.975)
mean.pred[i]  <- mean(predall[,i])
}
# 2. Plot
plot(-15, xlim=c(5,25), ylim=c(0, 2000), main = s_temp[xxx], xlab = "Temperature", ylab = "Abundance") # area_SG_HA unscaled variable
polygon( x = c(temp_pred, rev(temp_pred)),
y = c(lci, rev(uci)),
col = adjustcolor(c("grey"),alpha.f = 0.6),
border = NA)
points(mean.pred ~ temp_pred, type="l")
}
mtext("Temperature", side = 1, line = 1, cex = 1.2, outer = TRUE)
mtext("Sigma", side = 2, line = 1, cex = 1.2, outer = TRUE)
par(mfrow = c(3,1),
mar = c(2,2,3,2),
oma = c(2,3,1,2))
s_temp <- temp_sig$sp
s_temp <- s_temp[c(2,6,7)]
#dev.off()
setwd("S:/PhD/Second chapter/Data/Results/TRIM/6temp")
load(paste("HDS_",s_temp[xxx],".RData", sep = ""))
s_temp <- s_temp[c(2,6,7)]
for (xxx in 1:3){
#dev.off()
setwd("S:/PhD/Second chapter/Data/Results/TRIM/6temp")
load(paste("HDS_",s_temp[xxx],".RData", sep = ""))
# 1. Predictions of the model Sigma ~ Temperature
temp_pred <- seq(5, 30, length.out = 500)
outall <- do.call(rbind,out$samples)
pred <- list()
for(i in 1:dim(outall)[1]){
pred[[i]] <- exp(outall[i,"mu.sig"] +
outall[i,"bTemp.sig"]*temp_pred) } # Pred contains the list of the prediction of sigma for each iteration #(one prediction line per iteration)
predall <- do.call(rbind,pred) # All predictions/iterations together in one data frame (where columns are the prediction per each predictor (area) values)
lci <- uci <- mean.pred <- 0
for(i in 1:length(temp_pred)){
lci[i]  <- quantile(predall[,i],probs = 0.025)
uci[i]  <- quantile(predall[,i],probs = 0.975)
mean.pred[i]  <- mean(predall[,i])
}
# 2. Plot
plot(-15, xlim=c(5,25), ylim=c(-10, 300), main = s_temp[xxx], xlab = "Temperature", ylab = "Abundance") # area_SG_HA unscaled variable
polygon( x = c(temp_pred, rev(temp_pred)),
y = c(lci, rev(uci)),
col = adjustcolor(c("grey"),alpha.f = 0.6),
border = NA)
points(mean.pred ~ temp_pred, type="l")
}
##♠ ?? This is wrong, ask Rahel how to plot predictions in sigma
mtext("Temperature", side = 1, line = 1, cex = 0.8, outer = TRUE)
mtext("Sigma", side = 2, line = 1, cex = 0.8, outer = TRUE)
s_temp <- temp_sig$sp
s_temp
s_temp <- s_temp[c(2,6,7)]
s_temp
for (xxx in 1:3){
#dev.off()
setwd("S:/PhD/Second chapter/Data/Results/TRIM/6temp")
load(paste("HDS_",s_temp[xxx],".RData", sep = ""))
# 1. Predictions of the model Sigma ~ Temperature
temp_pred <- seq(5, 30, length.out = 500)
outall <- do.call(rbind,out$samples)
pred <- list()
for(i in 1:dim(outall)[1]){
pred[[i]] <- exp(outall[i,"mu.sig"] +
outall[i,"bTemp.sig"]*temp_pred) } # Pred contains the list of the prediction of sigma for each iteration #(one prediction line per iteration)
predall <- do.call(rbind,pred) # All predictions/iterations together in one data frame (where columns are the prediction per each predictor (area) values)
lci <- uci <- mean.pred <- 0
for(i in 1:length(temp_pred)){
lci[i]  <- quantile(predall[,i],probs = 0.025)
uci[i]  <- quantile(predall[,i],probs = 0.975)
mean.pred[i]  <- mean(predall[,i])
}
# 2. Plot
plot(-15, xlim=c(5,25), ylim=c(-10, 300), main = s_temp[xxx], xlab = "Temperature", ylab = "Abundance") # area_SG_HA unscaled variable
polygon( x = c(temp_pred, rev(temp_pred)),
y = c(lci, rev(uci)),
col = adjustcolor(c("grey"),alpha.f = 0.6),
border = NA)
points(mean.pred ~ temp_pred, type="l")
}
par(mfrow = c(3,1),
mar = c(2,2,3,2),
oma = c(2,3,1,2))
s_temp <- temp_sig$sp
s_temp <- s_temp[c(2,6,7)]
for (xxx in 1:3){
#dev.off()
setwd("S:/PhD/Second chapter/Data/Results/TRIM/6temp")
load(paste("HDS_",s_temp[xxx],".RData", sep = ""))
# 1. Predictions of the model Sigma ~ Temperature
temp_pred <- seq(5, 30, length.out = 500)
outall <- do.call(rbind,out$samples)
pred <- list()
for(i in 1:dim(outall)[1]){
pred[[i]] <- exp(outall[i,"mu.sig"] +
outall[i,"bTemp.sig"]*temp_pred) } # Pred contains the list of the prediction of sigma for each iteration #(one prediction line per iteration)
predall <- do.call(rbind,pred) # All predictions/iterations together in one data frame (where columns are the prediction per each predictor (area) values)
lci <- uci <- mean.pred <- 0
for(i in 1:length(temp_pred)){
lci[i]  <- quantile(predall[,i],probs = 0.025)
uci[i]  <- quantile(predall[,i],probs = 0.975)
mean.pred[i]  <- mean(predall[,i])
}
# 2. Plot
plot(-15, xlim=c(5,25), ylim=c(-10, 300), main = s_temp[xxx], xlab = "Temperature", ylab = "Abundance") # area_SG_HA unscaled variable
polygon( x = c(temp_pred, rev(temp_pred)),
y = c(lci, rev(uci)),
col = adjustcolor(c("grey"),alpha.f = 0.6),
border = NA)
points(mean.pred ~ temp_pred, type="l")
}
##♠ ?? This is wrong, ask Rahel how to plot predictions in sigma
mtext("Temperature", side = 1, line = 1, cex = 0.8, outer = TRUE)
mtext("Sigma", side = 2, line = 1, cex = 0.8, outer = TRUE)
rm(list=ls())
library(dplyr)
library(tidyr)
library(stats)
setwd("S:/PhD/Second chapter/Data")
s <- read.csv("sp_trend_dg.csv", sep = ";")
s_good <- as.vector(s$Species[which(s$include_samplesize == 1)])
remove_6 <- c("CACHL", "CAINA", "CIJUN", "COCOT", "COLIV", "LUARB", "LUMEG", "MIMIG", "OEHIS", "ORORI", "PIVIR", "PYRAX", "STUNI", "STVUL", "TUMER", "TUVIS")
s_good <- s_good[-which(s_good %in% remove_6)] # SPECIES THAT CONVERGE FOR MODEL 6
setwd("S:/PhD/Second chapter/Data/Results/TRIM/6temp")
load("spConvergence_light.RData")
xxx = 16
setwd("S:/PhD/Second chapter/Data/Results/TRIM/6temp")
load(paste("HDS_",s_good[xxx],".RData", sep = ""))
library(dplyr)
install.packages("tidyselect")
library(dplyr)
library(tidyr)
library(stats)
setwd("S:/PhD/Second chapter/Data")
s <- read.csv("sp_trend_dg.csv", sep = ";")
s_good <- as.vector(s$Species[which(s$include_samplesize == 1)])
remove_6 <- c("CACHL", "CAINA", "CIJUN", "COCOT", "COLIV", "LUARB", "LUMEG", "MIMIG", "OEHIS", "ORORI", "PIVIR", "PYRAX", "STUNI", "STVUL", "TUMER", "TUVIS")
s_good <- s_good[-which(s_good %in% remove_6)] # SPECIES THAT CONVERGE FOR MODEL 6
setwd("S:/PhD/Second chapter/Data/Results/TRIM/6temp")
load("spConvergence_light.RData")
xxx = 16
setwd("S:/PhD/Second chapter/Data/Results/TRIM/6temp")
load(paste("HDS_",s_good[xxx],".RData", sep = ""))
outall <- do.call(rbind,out$samples) # All iterations from MCMC
outall_obs <- as.data.frame(outall[ , grep("sig.obs", colnames(outall))])
obs <- gather(outall_obs, key = "observer", value = "sigma", factor_key = TRUE)
# Summary statistics
group_by(obs, observer) %>%
summarise(
count = n(),
mean = mean(sigma, na.rm = TRUE),
sd = sd(sigma, na.rm = TRUE)
)
#Boxplot
boxplot(sigma ~ observer, data = obs,
xlab = "Observer", ylab = "Sigma",
frame = FALSE, col = c("#00AFBB", "#E7B800", "#FC4E07"))
aov_obs <- aov(sigma ~ observer, data = obs)
summary(aov_obs) # There are significant differences among groups. Which groups?
pairwise <- TukeyHSD(aov_obs)
pairwise
k <- kruskal.test(sigma ~ observer, data = obs)
k
obs_id <- unique(obs$observer)
pairwise_np <- pairwise.wilcox.test(obs$sigma, obs_id, p.adjust.method = "BH")
pairwise_np
pairwise_np <- pairwise.wilcox.test(obs$sigma, obs$observer, p.adjust.method = "BH")
pairwise_np
s_good
#for (xxx in 1:length(s_good)){
xxx = 5
setwd("S:/PhD/Second chapter/Data/Results/TRIM/6temp")
load(paste("HDS_",s_good[xxx],".RData", sep = ""))
outall <- do.call(rbind,out$samples) # All iterations from MCMC
outall_obs <- as.data.frame(outall[ , grep("sig.obs", colnames(outall))])
obs <- gather(outall_obs, key = "observer", value = "sigma", factor_key = TRUE)
# Summary statistics
group_by(obs, observer) %>%
summarise(
count = n(),
mean = mean(sigma, na.rm = TRUE),
sd = sd(sigma, na.rm = TRUE)
)
#Boxplot
boxplot(sigma ~ observer, data = obs,
xlab = "Observer", ylab = "Sigma",
frame = FALSE, col = c("#00AFBB", "#E7B800", "#FC4E07"))
aov_obs <- aov(sigma ~ observer, data = obs)
summary(aov_obs) # There are significant differences among groups. Which groups?
pairwise <- TukeyHSD(aov_obs)
k <- kruskal.test(sigma ~ observer, data = obs)
obs_id <- unique(obs$observer)
pairwise_np <- pairwise.wilcox.test(obs$sigma, obs$observer, p.adjust.method = "BH")
pairwise_np
head(obs)
hist(`sig.obs[1]`)
hist(outall_obs$`sig.obs[1]`)
pairwise
s_good[xxx]
group_by(obs, observer) %>%
summarise(
count = n(),
mean = mean(sigma, na.rm = TRUE),
sd = sd(sigma, na.rm = TRUE)
)
boxplot(sigma ~ observer, data = obs,
xlab = "Observer", ylab = "Sigma",
frame = FALSE
)
aov_obs <- aov(sigma ~ observer, data = obs)
summary(aov_obs) # There are significant differences among groups. Which groups?
# Does it meet the assumptions of ANOVA??
# 1. Homoneneity of variances
plot(aov_obs, 1)
plot(aov_obs,1)
